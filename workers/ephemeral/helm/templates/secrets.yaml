{{- $fullname := include "sandbox_workers.fullname" . }}
{{- if .Values.image.credentials -}}
---
apiVersion: v1
kind: Secret
metadata:
  name: {{ printf "%s-ephemeral-worker-docker" $fullname | trunc 63 | trimSuffix "-" }}
type: kubernetes.io/dockerconfigjson
data:
  .dockerconfigjson: {{ template "imagePullSecret" . }}
{{- end }}

{{- if .Values.queue.password }}
---
apiVersion: v1
kind: Secret
metadata:
  name: {{ printf "%s-worker-queue-redis-token" $fullname | trunc 63 | trimSuffix "-" }}
data:
  token: {{ .Values.queue.password | b64enc }}
{{- end }}

{{- if .Values.kvstore.password }}
---
apiVersion: v1
kind: Secret
metadata:
  name: {{ printf "%s-worker-kvstore-redis-token" $fullname | trunc 63 | trimSuffix "-" }}
data:
  token: {{ .Values.kvstore.password | b64enc }}
{{- end }}

{{- if .Values.superblocks.key }}
---
apiVersion: v1
kind: Secret
metadata:
  name: {{ printf "%s-worker-agent-key" $fullname | trunc 63 | trimSuffix "-" }}
data:
  key: {{ .Values.superblocks.key | b64enc }}
{{- end }}

